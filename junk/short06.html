<hr/><canvas id="cnvs"></canvas><hr/>
<script>
const getp=function(g, src){
	const FS=WebGLRenderingContext.FRAGMENT_SHADER;
	var p=g.createProgram();
	g.attachShader(p, cs(FS+1, src[0]));	g.attachShader(p, cs(FS+0, src[1]));
	g.linkProgram(p);	console.log("link:"+g.getProgramInfoLog(p));
	if(g.getProgramParameter(p, 0x8B82)){return p;}else{g.deleteProgram(p);}
	function cs(t, src){
		console.log(src);
		var s=g.createShader(t);	g.shaderSource(s, src);
		g.compileShader(s);console.log("compile("+t+"):"+g.getShaderInfoLog(s));
		if(g.getShaderParameter(s, 0x8B81)){return s}else{g.deleteShader(s);}
	}
}
const setb=function(g, p, id, data){
	const ABUF=g.ARRAY_BUFFER, STAT=g.STATIC_DRAW;
	var loc=g.getAttribLocation(p, id);	g.enableVertexAttribArray(loc);
	g.bindBuffer(ABUF, g.createBuffer());
	g.vertexAttribPointer(loc, 2, g.FLOAT, false, 0, 0);
	g.bufferData(ABUF, new Float32Array(data), STAT);
	g.bindBuffer(ABUF, null);
}
//
const CNVS=document.getElementById("cnvs");
const g=CNVS.getContext("webgl",{preserveDrawingBuffer:true});
const vs=`attribute vec3 s;
void main(){gl_PointSize=8.;gl_Position=vec4(s,1.);}`;
const fs=`precision mediump float;
void main(){gl_FragColor=vec4(1.,1.,0.,1);}`;
var mode=true;
const chgmod=function(){mode=!mode;console.log(mode);};
CNVS.addEventListener("click", chgmod);
const run=function(){
	var t=0, p=getp(g, [vs,fs]);	g.useProgram(p);
	const draw=function(){
		var a=[0,0, Math.cos(t),0, 0,Math.sin(t),];
		var dm=(mode)?g.POINTS:g.TRIANGLES;
		g.clearColor(0,.3,0,1);	g.clear(g.COLOR_BUFFER_BIT);
		setb(g, p, "s", a);	g.drawArrays(dm, 0, a.length/2);
	}
	const anim=function(){
		t=((t+=.01)<Math.PI*2)?t:0;	draw();
		window.requestAnimationFrame(anim);
	};	anim();
};	run();
</script>