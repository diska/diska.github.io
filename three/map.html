<!DOCTYPE html>
<html lang="ja">
<head>
 <meta charset="utf-8">
 <title>MapTemplate</title>
</head>
<body>
<div id="divMapElement" style="width:800px; height:600px">
<canvas id="canvasElement" style="width:800px; height:600px"></canvas>
<script src="three.min.js"></script>
<script src="controls/OrbitControls.js"></script>
<script>
(function(){
	var width=800, height=600;
	// Scene
	var scene=new THREE.Scene();

	// Mesh
	var cube, json;
    //オブジェクト
	function addMap(){
	    loader=new THREE.JSONLoader();
	    loader.load('./rakazanar-o-mesh2.json', function(geometry, materials){
			materials[0].shading=THREE.FlatShading;
	        var faceMaterial=new THREE.MeshFaceMaterial(materials);
	        json = new THREE.Mesh(geometry, faceMaterial);
	        json.position.set(0, 0, 0);
//	        json.scale.set(.1, .1, .1);
//	        json.scale.set(10, 10, 10);
	        scene.add( json );
	    });
	}

	// helper
	function addHelper(){
		var axis=new THREE.AxisHelper(1000);
		axis.position.set(0, 0, 0);
		scene.add(axis);
	}

	// Light
	function addAmbientLight(){
		// 空気
		var ambient=new THREE.AmbientLight(0x663399);
		scene.add(ambient);
	}
	function addSunLight(){
		// 太陽？
		var light=new THREE.DirectionalLight(0x99ffcc, 1);
		light.position.set(10, 10, -1);
		light.castShadow =true;
		scene.add(light);

		light=new THREE.DirectionalLight(0xffcc99, 1);
		light.position.set(-10, 10, 1);
		light.castShadow =true;
		scene.add(light);
	}
	function addPointLight(xpos, ypos, zpos){
		light = new THREE.PointLight( 0xcc99ff, 4, 120);
		light.position.set(xpos, ypos, zpos);
		scene.add( light );
	}
	// 霧
	scene.fog=new THREE.Fog(0x663399, .5, 3000);

	addMap();
	addHelper();
	addAmbientLight();
//	addSunLight();
	addPointLight(15, 5, 0);
	addPointLight(-15, 5, 0);
	addPointLight(0, 5, 15);
	addPointLight(0, 5, -15);

	addPointLight(100, 5, 20);
	addPointLight(100, 5, -20);
	addPointLight(20, 5, 100);
	addPointLight(-20, 5, 100);
	addPointLight(-100, 5, 20);
	addPointLight(-100, 5, -20);
	addPointLight(20, 5, -100);
	addPointLight(-20, 5, -100);

	// カメラ
	var camera;
	function addCamera(){
		camera=new THREE.PerspectiveCamera(45, width/height, .5, 500);
		camera.position.set(0, 300, 2);
//		camera.position.set(0, 30, 2);
		camera.lookAt(new THREE.Vector3(0,0,0));
		scene.add(camera);
	}
	addCamera();

	//　レンダリング
	var controls=new THREE.OrbitControls(camera);
	function render(){
		function animate(){
			requestAnimationFrame(animate);
//			controls.update();
			renderer.render(scene, camera);
		}
		canvasElement=document.getElementById("canvasElement");
		var renderer=new THREE.WebGLRenderer({canvas: canvasElement});
		renderer.setSize(width,height);
		renderer.setClearColor(0x663399, 1);
		renderer.shadowMapEnabled =true;
		animate();
	}
	render();
})();
</script>
</div>
</body>
</html>
